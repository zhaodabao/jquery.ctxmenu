/*! jQuery Contextmenu Plugin v1.0.2
Zhao Chengjia 2016-02-22 */
(function(e,h){var g={id:{ns:"ctxEventNS",prefix:"ctxContext-",ctxData:"ctxOpt",dynamic:"ctxDynamic",menu:"ctxMenu",enable:"ctxEnable",owners:"ctxOwners"},className:{popupDiv:"ctxmenu",cover:"cover",separator:"separator",hover:"hover",disabled:"disabled"}},b={menu:null,mouseBtn:"right",minWidth:120,maxWidth:0,isHoverIntent:true,hoverIntentDelay:400,animationDelay:300,animationMode:"easeOutBack"},d=[],a={init:function(l){l=e.extend({},b,l);if(!l.menu||!e.isArray(l.menu)){return false}var k,j=g.id,i=g.className;e("."+i.popupDiv).length>0&&e("."+i.popupDiv).remove();k=e("<div/>").append(f(l.menu)).data(j.dynamic,true).appendTo(e("body"));return this.each(function(){var n=e(this),m=j.prefix+(new Date().getTime());n.data(j.ns,m).data(j.ctxData,l).data(j.menu,k).data(j.enable,true);!k.data(j.owners)&&k.data(j.owners,[]);k.data(j.owners).push(n);d.push(k);a.refresh.call(n,null);n.bind((l.mouseBtn+"."+m),function(o){if(!n.data(j.enable)){return true}a.show.apply(n,[o.pageX,o.pageY]);return false});k.find("li:not(.disabled)").each(function(){e(this).bind("click",function(){var o=e("div:first",e(this)).data("opt");e.isFunction(o.action)&&o.action.call(this,o)})})})},refresh:function(m){var i,l=g.id,j=g.className;return this.each(function(){var r=e(this),q=r.data(l.menu),o,p;i=e.extend(r.data(l.ctxData),m);i.isHoverIntent&&!e.fn.hoverIntent&&(i.isHoverIntent=false);q.removeClass(j.popupDiv);e("li",q).removeClass(j.hover);e("span",q).remove();q.addClass(j.popupDiv);p=e("<div/>").addClass(j.popupDiv).appendTo("body");e("ul",q).each(function(){p.html("");o=0;p.html(e(this).html());o=p.width()+16;o<i.minWidth&&(o=i.minWidth);o>i.maxWidth&&i.maxWidth>0&&(o=i.maxWidth);e(this).width(o);e(this).children("li").children("ul").css("left",o)});p.remove();e("li:has(ul)",q).each(function(){if(!e(this).hasClass(j.disabled)){e("div:first",this).append(e("<span/>"));i.isHoverIntent?e(this).hoverIntent({over:function(){k.call(this,i)},out:function(){n.call(this,i)},timeout:i.hoverIntentDelay}):e(this).hover(function(){k.call(this,i)},function(){n.call(this,i)})}});e("li",q).each(function(){if(!e(this).hasClass(j.disabled)){e(this).click(function(){if(e("ul",this).length<1){e("li",q).unbind("click");q.fadeOut(i.animationDelay)}return false})}e(this).hover(function(){e(this).parent().find("li."+j.hover).removeClass(j.hover);e(this).addClass(j.hover)},function(){e(this).removeClass(j.hover)})})});function k(q){var o,r,t,s,v=e(this),w=v.children("."+j.cover),p=w.children("ul").stop(true,true),u=20;w.show();o=v.parent().width();r=v.position().top+6;w.css({left:o,top:r,width:p.outerWidth()+u,height:p.outerHeight(),overflow:"hidden"});t=w.offset();s=e.extend({},t);c(s,w,true);s.top<t.top&&w.css({top:r+v.outerHeight()-w.outerHeight()});if(s.left<t.left){o=-w.width();w.css({left:o});p.css({left:w.width()}).animate({left:u},q.animationDelay,q.animationMode,function(){w.css({left:o+u,width:p.outerWidth(),overflow:"visible"});p.css({left:0})})}else{p.css({left:-(o+5)}).animate({left:0},q.animationDelay,q.animationMode,function(){w.css({width:p.outerWidth(),overflow:"visible"})})}}function n(r){var p=e(this).children("."+j.cover),o=p.children("ul").stop(true,true),q=p.position().left<0?o.width():-(o.width()+5);p.css({overflow:"hidden"});o.animate({left:q},r.animationDelay,r.animationMode,function(){p.hide()})}},restore:function(){var i=g.id;return this.each(function(){var k=e(this),j=k.data(i.menu);k.unbind("."+k.data(i.ns));e(window).unbind("keydown."+k.data(i.ns));e(document).unbind("click."+k.data(i.ns));e.each(j.data(i.owners),function(l){k[0]===this&&j.data(i.owners).splice(l,1)});if(j.data(i.owners).length<1){e.each(d,function(l){j[0]===this&&d.splice(l,1)});j.data(i.dynamic)&&j.remove()}k.removeData(i.ns);k.removeData(i.menu);k.removeData(i.ctxData);k.removeData(i.enable)})},show:function(p,n){if(!p||!n){e.error("the position of the menu has not been specified");return false}var l=e(this).first(),i=l.data(g.id.menu),m=l.data(g.id.ctxData),j=i.css("visibility"),o;i.css("visibility","hidden").data(g.id.menu,e(this));o=c({top:n,left:p},i,true);i.offset(o).css("visibility",j);if(n>o.top){var k=i.height(),q=o.top;i.css({height:0,top:q+k}).show().animate({height:k,top:q},m.animationDelay)}else{i.slideDown(m.animationDelay)}return this},hide:function(){var j=g.id,i=g.className,k=e(this).first().data(j.menu).animationDelay;e.each(d,function(){var l=e(this);e("."+i.hover,this).removeClass(i.hover);e("ul:first ul",this).fadeOut(k);!!l.data(j.menu)&&l.removeData(j.menu);l.fadeOut(k)});return this},disable:function(i){var n=e(this),j=g.id,l=g.className.disabled;if(!!i){var k=n.data(j.menu);i.charAt(0)===""?e("li"+i.replace(/ /g,"_"),k).addClass(l):e('div[action="'+i+'"]',k).parent().addClass(l)}else{n.data(j.enable,false)}return this},enable:function(i){var n=e(this),j=g.id,l=g.className.disabled;if(!!i){var k=n.data(j.menu);i.charAt(0)===""?e("li"+i.replace(/ /g,"_"),k).removeClass(l):e('div[action="'+i+'"]',k).parent().removeClass(l)
}else{n.data(j.enable,true);e("li",this).each(function(){e(this).removeClass(l)})}return this}},c=function(j,k,i){if(j.top){if((j.top+k.height()+10-e(window).scrollTop())>e(window).height()){j.top=i?(j.top-k.height()-5):(e(window).height()+e(window).scrollTop()-k.height()-5)}if(j.top<e(window).scrollTop()){j.top=e(window).scrollTop()}}if(j.left){if((j.left+k.width()+10-e(window).scrollLeft())>e(window).width()){j.left=e(window).width()-k.width()+e(window).scrollLeft()-5}if(j.left<e(window).scrollLeft()){j.left=e(window).scrollLeft()-5}}return j},f=function(i){if(!i||!e.isArray(i)){return}var k=e("<ul/>"),l,j=g.className;e.each(i,function(m,o){if(o.hidden){return true}l=e("<li/>").attr("id",o.id.replace(/ /g,"_")).append(e("<div/>").data("opt",o).text(o.text));!!o.image&&l.append(e("<img/>").attr("src",o.image));!!o.separator&&l.addClass(j.separator);!!o.disabled&&l.addClass(j.disabled);k.append(l);!!o.children&&l.append(f(o.children))});return e("<div/>").addClass(j.cover).append(k)};e.fn.extend({ctxmenu:function(){var i=arguments[0];if(a[i]){return a[i].apply(this,Array.prototype.slice.call(arguments,1))}else{if(typeof i==="object"||!i){return a.init.apply(this,arguments)}else{e.error("Method "+i+" does not exist in jquery.contextmenu");return this}}}})})(jQuery);